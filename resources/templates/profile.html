<!-- Include Bootstrap CSS -->
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha384-oS3vJWv+0Ujz5feU7U8Jr5mC2J5EM2F5w5G5F5z5z5z5z5z5z5z5z5z5z5z5z5z5z" crossorigin="anonymous">

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>

<link rel="stylesheet" href="/css/profile.css">
<link rel="stylesheet" href="/fonts/icomoon/style.css">

<div class="container">
    <div class="row">
        <div class="col-12">
            <!-- Page title -->
            <div class="my-5">
                <h3><a th:href="@{/}">Home</a></h3>
                <hr>
            </div>
            <!-- Form START -->
            <form class="file-upload">
                <div class="row mb-5 gx-5">
                    <!-- Contact detail -->
                    <div class="col-xxl-8 mb-5 mb-xxl-0">
                        <div class="bg-secondary-soft px-4 py-5 rounded">
                            <div class="row g-3">
                                <h4 class="mb-4 mt-0"><strong>Account details:</strong></h4>
                                <!-- First Name -->
                                <div class="col-md-6">
                                    <label class="form-label"><strong>Username</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="First name" th:value="${user.getUsername()}" readonly>
                                </div>
                                <!-- Last name -->
                                <div class="col-md-6">
                                    <label class="form-label"><strong>Email</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Last name" th:value="${user.getEmail()}" readonly>
                                </div>
                                <!-- Phone number -->
                                <div class="col-md-6">
                                    <label class="form-label"><strong>Created</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Phone number" th:value="${user.getCreated()}" readonly>
                                </div>
                                <!-- Mobile number -->
                                <div class="col-md-6">
                                    <label class="form-label"><strong>Phone number</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Phone number" th:value="${user.getMobileNumber()}" readonly>
                                </div>
                                <!-- Email -->
                                <div class="col-md-6">
                                    <label for="inputEmail4" class="form-label"><strong>Age</strong></label>
                                    <input type="email" class="form-control" id="inputEmail4" th:value="${user.getAge()}" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Upload profile -->
                    <div class="col-xxl-4">
                        <div class="bg-secondary-soft px-4 py-5 rounded">
                            <div class="row g-3">
                                <h4 class="mb-4 mt-0"><strong>Upload profile picture</strong></h4>
                                <div class="text-center">
                                    <!-- Image upload -->
                                    <div class="square position-relative display-2 mb-3">
                                        <i class="fas fa-fw fa-user position-absolute top-50 start-50 translate-middle text-secondary"></i>
                                    </div>
                                    <!-- Button -->
                                    <input type="file" id="customFile" name="file" hidden="">
                                    <label class="btn btn-success-soft btn-block" for="customFile">Upload</label>
                                    <button type="button" class="btn btn-danger-soft">Remove</button>
                                    <!-- Content -->
                                    <p class="text-muted mt-3 mb-0"><span class="me-1">Note:</span>Minimum size 300px x 300px</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> <!-- Row END -->
            </form> <!-- Social media detail -->
                <div class="row mb-5 gx-5">
                    <div class="col-xxl-6 mb-5 mb-xxl-0">
                        <div class="bg-secondary-soft px-4 py-5 rounded">
                            <div class="row g-3">
                                <h4 class="mb-4 mt-0"><strong>Social Media</strong></h4>
                                <!-- Facebook -->
                                <div class="col-md-6">
                                    <label class="form-label"><i class="fab fa-fw fa-facebook me-2 text-facebook"></i><strong>Facebook</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Facebook" value="http://www.facebook.com">
                                </div>
                                <!-- Twitter -->
                                <div class="col-md-6">
                                    <label class="form-label"><i class="fab fa-fw fa-twitter text-twitter me-2"></i><strong>Twitter</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Twitter" value="http://www.twitter.com">
                                </div>
                                <!-- Linkedin -->
                                <div class="col-md-6">
                                    <label class="form-label"><i class="fab fa-fw fa-linkedin-in text-linkedin me-2"></i><strong>Linkedin</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Linkedin" value="http://www.linkedin.com">
                                </div>
                                <!-- Instragram -->
                                <div class="col-md-6">
                                    <label class="form-label"><i class="fab fa-fw fa-instagram text-instagram me-2"></i><strong>Instagram</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Instragram" value="http://www.instragram.com">
                                </div>
                                <!-- Dribble -->
                                <div class="col-md-6">
                                    <label class="form-label"><i class="fas fa-fw fa-basketball-ball text-dribbble me-2"></i><strong>Dribble</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Dribble" value="http://www.dribble.com">
                                </div>
                                <!-- Pinterest -->
                                <div class="col-md-6">
                                    <label class="form-label"><i class="fab fa-fw fa-pinterest text-pinterest"></i><strong>Pinterest</strong></label>
                                    <input type="text" class="form-control" placeholder="" aria-label="Pinterest" value="http://www.pinterest.com">
                                </div>
                            </div> <!-- Row END -->
                        </div>
                    </div>
                    <!-- change password -->
                    <div class="col-xxl-6">
                        <div class="bg-secondary-soft px-4 py-5 rounded">
                            <form th:method="PUT" th:action="@{/profile/update}">
                            <div class="row g-3">
                                <h4 class="my-4"><strong>Change Password</strong></h4>
                                <!-- Old password -->
                                <div class="col-md-6">
                                    <label for="exampleInputPassword1" class="form-label"><strong>Old Password *</strong></label>
                                    <input name="oldPassword" required minlength="5" maxlength="25" type="password" class="form-control" id="exampleInputPassword1">
                                </div>
                                <!-- New password -->
                                <div class="col-md-6">
                                    <label for="exampleInputPassword2" class="form-label"><strong>New Password *</strong></label>
                                    <input name="newPassword" required minlength="5" maxlength="25" type="password" class="form-control" id="exampleInputPassword2">
                                </div>
                                <!-- Confirm password -->
                                <div class="col-md-12">
                                    <label for="exampleInputPassword3" class="form-label"><strong>Confirm Password *</strong></label>
                                    <input name="confirmPassword" required minlength="5" maxlength="25" type="password" class="form-control" id="exampleInputPassword3">
                                </div>
                                <div th:if="${wrongPassword}" class="alert alert-danger alert-dismissible fade show" role="alert">
                                     Your old password didn't match.
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div th:if="${wrongPasswordConfirmation}" class="alert alert-danger alert-dismissible fade show" role="alert">
                                    Your confirmations didn't match.
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
              </div>
                <div class="gap-3 d-md-flex justify-content-md-end text-center">
                    <button type="submit" style="height: 48px" class="btn btn-outline-warning btn-lg">Update profile</button>
                    </form>
                    <form>
                        <button type="button" class="btn btn-outline-info btn-lg"  data-toggle="modal" data-target="#modalCart">Reservations</button>
                    </form>
                    <form>
                        <button type="button" class="btn btn-outline-danger btn-lg" data-toggle="modal" data-target="#ConfirmDelete">Delete profile</button>
                    </form>
                    <div sec:authorize="hasRole('ADMIN')" class="btn-group dropup">
                        <button style="width: 144px; height: 48px" type="button" class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="sr-only">Admin options</span>
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" id="addMovie" href="#">Add Movie</a>
                        </div>
                    </div>
                    <div class="modal fade" id="modalCart" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <!--Header-->
                                <div class="modal-header">
                                    <h4 class="modal-title" id="myModalLabel">Tickets purchased</h4>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <table class="table table-hover">
                                        <thead>
                                        <tr>
                                            <th>Id</th>
                                            <th>Movie name</th>
                                            <th>Price</th>
                                            <th>Remove</th>
                                        </tr>
                                        </thead>
                                        <tbody th:each="purchase : ${user.getPurchases()}">
                                        <tr>
                                            <th scope="row" th:text="${purchase.getId()}" style="padding: 10px"></th>
                                            <td th:text="${purchase.getMovie().movieName}" style="padding: 10px"></td>
                                            <td th:text="${purchase.getMovie().getPrice()} + '$'" style="padding: 10px"></td>
                                            <td>
                                                <button type="button" class="btn btn-outline-warning custom-small-button" style="font-size: 12px; padding: 5px 10px;" data-toggle="modal" data-target="#modalConfirmDelete">Remove</button>
                                                <!--Modal: modalConfirmDelete-->
                                                <div class="modal fade" id="modalConfirmDelete" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                                                     aria-hidden="true">
                                                    <div class="modal-dialog modal-sm modal-notify modal-danger" role="document">
                                                        <!--Content-->
                                                        <div class="modal-content text-center">
                                                            <!--Header-->
                                                            <div class="modal-header d-flex justify-content-center">
                                                                <p class="heading">Delete confirmation</p>
                                                            </div>
                                                            <!--Body-->
                                                            <div class="modal-body">
                                                                <p>Are you sure of dropping off the ticket reservation with ID:
                                                                    <strong th:text="${purchase.getId()}"></strong> ?</p>
                                                            </div>
                                                            <!--Footer-->
                                                            <div class="modal-footer flex-center">
                                                                <form th:method="DELETE" th:action="@{/profile/delete/{id}(id=${purchase.getId()})}">
                                                                    <button type="submit" class="btn btn-outline-danger" id="confirmDeleteYes">Confirm</button>
                                                                </form>
                                                                <a type="button" class="btn btn-danger waves-effect" data-dismiss="modal">Dismiss</a>
                                                            </div>
                                                        </div>
                                                        <!--/.Content-->
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-outline-primary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="ConfirmDelete" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog modal-notify modal-danger" role="document">
                            <!--Content-->
                            <div class="modal-content text-center">
                                <div class="modal-header d-flex justify-content-center">
                                    <p class="heading"><strong>Delete confirmation:</strong></p>
                                </div>
                                <!--Body-->
                                <div class="modal-body">
                                    <div class="alert alert-warning" role="alert">
                                        Are you sure you want to delete your account? This action cannot be undone.
                                    </div>
                                    <form th:method="DELETE" th:action="@{/profile/delete}">
                                    <div class="form-group">
                                        <label for="password">Enter Your Password:</label>
                                        <input name="password" type="password" class="form-control" id="password" placeholder="Password" required>
                                    </div>
                                </div>

                                <div class="modal-footer flex-center">
                                        <button type="submit" class="btn btn-outline-danger">Delete</button>
                                    </form>
                                    <button type="button" class="btn btn-danger waves-effect" data-dismiss="modal">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
<div class="modal fade custom-movie-modal" id="movieModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add Movie</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form id="movieForm" th:method="POST" th:action="@{/profile/admin/addMovie}">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="title">Title:</label>
                        <input type="text" class="form-control" id="title" name="movieName" required>
                    </div>
                    <div class="form-group">
                        <label for="title">Price:</label>
                        <input type="text" class="form-control" id="price" name="price" required>
                    </div>
                    <div class="form-group">
                        <label>Category:</label>
                        <label for="exampleFormControlSelect1"></label><select class="form-control" id="exampleFormControlSelect1" name="category">
                            <option>Action</option>
                            <option>Horror</option>
                            <option>Animation</option>
                            <option>Humour</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="releaseDate">Release Date:</label>
                        <input type="date" class="form-control" id="releaseDate" name="premiere" required>
                    </div>
                    <div class="form-group">
                        <label for="releaseDate">Video Url:</label>
                        <input type="text" class="form-control" minlength="11" maxlength="11" name="videoUrl" required>
                    </div>
                    <div class="form-group">
                        <label for="releaseDate">Length:</label>
                        <input type="text" class="form-control" name="length" required>
                    </div>
                    <div class="form-group">
                        <label for="releaseDate">Detailed Picture:</label>
                        <input type="text" class="form-control" name="detailedPicture" required>
                    </div>
                </div>
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="message-text" class="col-form-label text-left">Short Description:</label>
                                <textarea class="form-control" name="shortDescription" required id="message-text"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="message-text2" class="col-form-label text-left">Long Description:</label>
                                <textarea class="form-control" name="longDescription" required id="message-text2"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add</button>
                </div>
            </form>
        </div>
    </div>
</div>
    <footer>
    <div style="margin-left: auto; margin-right: 0; text-align: center" th:if="${wrongPasswordMatch}" class="alert alert-danger alert-dismissible fade show custom-alert" role="alert">
        <strong>Wrong credentials!</strong> Check your password again.
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
        <div style="margin-left: auto; margin-right: 0; text-align: center" th:if="${successfulAddedMovie}" class="alert alert-success alert-dismissible fade show custom-alert" role="alert">
            <strong>Successful added movie!</strong>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </footer>

<script>
    document.getElementById("addMovie").addEventListener("click", function() {
        // Show the Bootstrap modal
        $('#movieModal').modal('show');
    });
</script>
</div>
</html>


